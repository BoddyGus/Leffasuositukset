<!DOCTYPE html>
<html>
<head>
  <title>Muokkaa elokuvaa</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>

  <h1>Muokkaa elokuvaa</h1>

  {% if session.username %}
    <p>Olet kirjautunut nimellä {{ session.username }}</p>
  {% endif %}

  <p class="nav-links">
    <a href="{{ url_for('reviews_bp.index') }}">Etusivu</a>
    | <a href="{{ url_for('reviews_bp.about') }}">Tietoa sovelluksesta</a>
    {% if not session.username %}
      | <a href="{{ url_for('user_bp.register') }}">Rekisteröidy</a>
      | <a href="{{ url_for('user_bp.login') }}">Kirjaudu</a>
    {% else %}
      | <a href="{{ url_for('user_bp.profile', username=session.username) }}">Profiili</a>
      | <a href="/logout">Kirjaudu ulos</a>
      | <a href="/new_item">Lisää uusi elokuva</a>
    {% endif %}
  </p>

  <form action="/items/{{ item.id }}/update" method="post">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
    <p>
      <label for="edit_title">Nimi:</label>
      <input id="edit_title" type="text" name="title" value="{{ item.title }}" required maxlength="75" />
      <small class="hint-text">Enintään 75 merkkiä</small>
    </p>
    <p>
      <label for="edit_genre">Tyylilaji (genre):</label>
      <select id="edit_genre" name="genre" required>
        <option value="">-- valitse genre --</option>
        {% for g in allowed_genres %}
          <option value="{{ g }}" {% if item.genre == g %}selected{% endif %}>{{ g }}</option>
        {% endfor %}
      </select>
    </p>
    <p>
      Tunnisteet (tunnelma): <br />
      {% for t in tags %}
        <label class="tag-checkbox">
          <input type="checkbox" name="tags" value="{{ t.id }}" {% if t.id in selected_tag_ids %}checked{% endif %} /> {{ t.name_fi }}
        </label>
      {% endfor %}
    </p>
    <p>
      <label for="edit_age_rating">Ikäraja:</label>
      <select id="edit_age_rating" name="age_rating" required>
        <option value="">-- valitse ikäraja --</option>
        <option value="U" {% if item.age_rating == 'U' %}selected{% endif %}>U – Sallittu kaikenikäisille</option>
        <option value="PG" {% if item.age_rating == 'PG' %}selected{% endif %}>PG – Vanhempien harkinta suositeltavaa</option>
        <option value="12" {% if item.age_rating == '12' %}selected{% endif %}>12 – Kielletty alle 12-vuotiailta</option>
        <option value="15" {% if item.age_rating == '15' %}selected{% endif %}>15 – Kielletty alle 15-vuotiailta</option>
        <option value="18" {% if item.age_rating == '18' %}selected{% endif %}>18 – Kielletty alle 18-vuotiailta</option>
      </select>
    </p>
    <p>
      <label for="edit_year">Vuosi:</label>
      <input id="edit_year" type="number" name="year" min="1888" max="{{ current_year }}" value="{{ item.year or '' }}" required />
    </p>
    <p>
      <label for="edit_description">Kuvaus:</label>
      <textarea id="edit_description" name="description" rows="4" cols="40" maxlength="350">{{ item.description or '' }}</textarea><br />
      <small class="hint-text">Enintään 350 merkkiä</small>
    </p>
    <input type="submit" value="Päivitä" />
    <a href="/">Peruuta</a>
  </form>
</body>
</html>